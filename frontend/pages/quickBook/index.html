<!DOCTYPE html>
<html lang="en">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <head>
        <title>Welcome to FlyDreamAir!</title>
        <link rel="stylesheet" href="quickBook.css">
        <link rel="stylesheet" href="../../components/header.css">
        <link rel="stylesheet" href="../../components/footer.css">
    </head>
    <body>
        <div id="header-placeholder"></div>

        <!-- search module section -->
        <section>
            <!-- div covering the banner image and the search module -->
            <div class="imgAndSearchSection">
                <!-- image -->
                <img src="../../images/headerLandscape.jpeg" alt="headerBackground" class="headerBackground">
                <!-- search module -->
                <div class="searchModule">
                    <div class="searchNavBar">
                        <nav class="searchChoices">
                            <a href="/frontend/pages/quickBook">Book</a>
                            <a href="/frontend/pages/quickManage">Manage</a>
                            <a href="/frontend/pages/quickUpdate/">Upgrade</a>
                            <a href="/frontend/pages/quickCheckIn/">Check-in</a>
                            <a href="/frontend/pages/quickCheckFlightStatus/">Flight Status</a>
                        </nav>
                    </div>
                    <div class="userSearchArea">
                        <div class="fromClass">
                            <div class="withIcon">
                                <div>From</div>
                                <div>
                                    <img src="../../images/location.png" alt="" class="inlineIcon smallerIcon">
                                </div>
                            </div>
                            <select id="fromAirport" class="input"></select>
                        </div>
                        <div class="toClass">
                            <div class="withIcon">
                                <div>To</div>
                                <div><img src="../../images/location.png" alt="" class="inlineIcon smallerIcon"></div>
                            </div>
                            <select id="toAirport" class="input"></select>
                        </div>
                        <div class="datesClass">
                            <div class="withIcon">
                                <div>Dates</div>
                                <div><img src="../../images/calendar.png" alt="" class="inlineIcon"></div>
                            </div>
                            <input type="date" class="input" id="flightDate">
                        </div>
                        <div class="priceRangeClass">
                            <div class="priceTitle">Price Range</div>
                            <div class="priceRanges">
                                $0
                                <input type="text" class="rangeAmount">
                                to
                                <input type="text" class="rangeAmount">
                                $10000
                            </div>
                            <!-- <input type="text" class="lowest">
                            <input type="text" class="highest"> -->
                        </div>
                    </div>
                    <!-- Handling adult, children, and infant amounts, and the search button -->
                     <div class="peopleAndSearch">
                        <div class="peopleAmount">
                            <div class="peopleType">
                                Adults <div class="age">12+ years</div>
                                <button class="pAmountButton" onClick="subtractAdult()">-</button>
                                <span id="adultAmount">1</span>
                                <button class="pAmountButton" onClick="addAdult()">+</button>
                            </div>
                            <div class="peopleType">
                                Children <div class="age">2-11 years</div>
                                <button class="pAmountButton" onClick="subtractChild()">-</button>
                                <span id="childAmount">0</span>
                                <button class="pAmountButton" onClick="addChild()">+</button>
                            </div>
                            <div class="peopleType">
                                Infants <div class="age">&lt;2 years</div>
                                <button class="pAmountButton" onClick="subtractInfant()">-</button>
                                <span id="infantAmount">0</span>
                                <button class="pAmountButton" onClick="addInfant()">+</button>
                            </div>
                        </div>
                        <div class="searchFlightsContainer">
                            <button class="blueButton" onClick="searchFlightsButton()">Search Flights</button>
                        </div>
                     </div>
                </div>
            </div>
        </section>
        <!-- New section: travel cards -->
        <section class="dealsSection">
            <div>
                <!-- Based on the results -->
                <div class="sectionHeading">Flight Deals from <span class="pickedCity">Sydney</span>
                <span class="arrow"> &#9662;</span></div>
            </div>
            <div id="flightResults" class="travelCardsContainer">
                <!-- Results will be rendered here -->
            </div>
        </section>
        <!-- New section: Airline info -->
        <section class="airlineInfoSection">
            <div class="infoBody">
              <div class="airlineImageContainer">
                <img src="../../images/airbus.jpg" alt="" class="airlineImage">
              </div>
              <div class="gridFour">
                <div class="infoHeading">Why choose FlyDreamAir?</div>
                <div class="airlineInfoContainer">
                  <div>
                    <div class="eachInfoGroup">
                      <img src="../../images/calendar.png" alt="" class="icon">
                    </div>
                    <p class="information">Egestas elit dui scelerisque ut eu purus aliquam vitae habitasse.</p>
                  </div>
                  <div>
                    <div class="eachInfoGroup">
                      <img src="../../images/car.png" alt="" class="icon">
                    </div>
                    <p class="information">Id eros pellentesque facilisi id mollis faucibus commodo enim.</p>
                  </div>
                  <div>
                    <div class="eachInfoGroup">
                      <img src="../../images/heartbeat.png" alt="" class="icon">
                    </div>
                    <p class="information">Tristique elementum, ac maecenas enim fringilla placerat scelerisque semper.</p>
                  </div>
          
                  <div>
                    <div class="eachInfoGroup">
                      <img src="../../images/bag.png" alt="" class="icon">
                    </div>
                    <p class="information">Curabitur magna cras euismod pharetra, mauris malesuada sit enim, elementum.</p>
                  </div>
                </div>
              </div>
            </div>
        </section>
        <section class="infoCardsSection">
            <div class="eachInfoCard">
                <div class="imageContainer">
                    <img src="../../images/travelcard_1.jpg" alt="Travel Image" class="cardImage">
                </div>
                <div class="cardAllText">
                    <p class="cardTitle">Title</p>
                    <p class="cardDescription">Lorem ipsum dolor sit amet, consectetur adipiscing elit.</p>
                    <a href="" class="learnMoreLink">Learn More &#9656;</a>
                </div>
            </div>
            <div class="eachInfoCard">
                <div class="imageContainer">
                  <img src="../../images/travelcard_1.jpg" alt="Travel Image" class="cardImage">
                </div>
                <div class="cardAllText">
                  <p class="cardTitle">Title</p>
                  <p class="cardDescription">Lorem ipsum dolor sit amet, consectetur adipiscing elit.</p>
                  <a href="" class="learnMoreLink">Learn More &#9656;</a>
                </div>
            </div>
            <div class="eachInfoCard">
                <div class="imageContainer">
                  <img src="../../images/travelcard_1.jpg" alt="Travel Image" class="cardImage">
                </div>
                <div class="cardAllText">
                  <p class="cardTitle">Title</p>
                  <p class="cardDescription">Lorem ipsum dolor sit amet, consectetur adipiscing elit.</p>
                  <a href="" class="learnMoreLink">Learn More &#9656;</a>
                </div>
            </div>
          </section>
          <!-- Section membership -->
          <section class="membershipSection">
            <div class="infoBody">
                <div class="gridTwo">
                    <div class="infoHeading">Why not become a member?</div>
                    <div class="membershipInfoContainer">
                        <div>
                            <div class="eachInfoGroup">
                                <img src="../../images/calendar.png" alt="" class="icon">
                            </div>
                            <p class="information">Egestas elit dui scelerisque ut eu purus aliquam vitae habitasse.</p>
                        </div>
                        <div>
                            <div class="eachInfoGroup">
                                <img src="../../images/heartbeat.png" alt="" class="icon">
                            </div>
                            <p class="information">Tristique elementum, ac maecenas enim fringilla placerat scelerisque semper.</p>
                        </div>
                        <div><button class="blueButton" onClick="joinTodayButton()">Join Today!</button></div>
                    </div>
                </div>
                <div class="airlineImageContainer">
                    <img src="../../images/airbus.jpg" alt="" class="airlineImage">
                </div>
            </div>
         </section>
         <!-- Javascript for people buttons -->
         <script>

            // intialise values for people amounts
            var initialAdult = 1;
            var initialChild = 0;
            var initialInfant = 0;

            function profileButton() {}

            function logOutButton() {}

            function addAdult() {
                // get the amount in the span
                var adultSpan = document.getElementById("adultAmount");
                // get the number and change to integer
                var adultNum = parseInt(adultSpan.innerHTML);
                // calculate
                var result = adultNum + 1;
                // display the new number
                var resultSpan = document.getElementById("adultAmount");
                resultSpan.innerHTML = result;
            }

            function subtractAdult() {
                // get hte amount in the span
                var adultSpan = document.getElementById("adultAmount");
                // get the number and change to integer
                var adultNum = parseInt(adultSpan.innerHTML);
                // calculate -- cannot be less than what is originally shown
                if (adultNum > 1) {
                    var result = adultNum - 1
                    // display the result
                    var resultSpan = document.getElementById("adultAmount");
                    resultSpan.innerHTML = result;
                }
            }


            function addChild() {
                // get the amount in the span
                var childSpan = document.getElementById("childAmount");
                // get the number and change to integer
                var childNum = parseInt(childSpan.innerHTML);
                // calculate
                var result = childNum + 1;
                // display the new number
                var resultSpan = document.getElementById("childAmount");
                resultSpan.innerHTML = result;
            }

            function subtractChild() {
                // get the amount in the span
                var childSpan = document.getElementById("childAmount");
                // get the number and change to integer
                var childNum = parseInt(childSpan.innerHTML);
                // calculate -- cannot be less than what is originally shown
                if (childNum > 0) {
                    var result = childNum - 1
                    // display the result
                    var resultSpan = document.getElementById("childAmount");
                    resultSpan.innerHTML = result;
                }
            }

            function addInfant() {
                // get the amount in the span
                var infantSpan = document.getElementById("infantAmount");
                // get the number and change to integer
                var infantNum = parseInt(infantSpan.innerHTML);
                // calculate
                var result = infantNum + 1;
                // display the new number
                var resultSpan = document.getElementById("infantAmount");
                resultSpan.innerHTML = result;
            }

            function subtractInfant() {
                // get the amount in the span
                var infantSpan = document.getElementById("infantAmount");
                // get the number and change to integer
                var infantNum = parseInt(infantSpan.innerHTML);
                // calculate -- cannot be less than what is originally shown
                if (infantNum > 0) {
                    var result = infantNum - 1
                    // display the result
                    var resultSpan = document.getElementById("infantAmount");
                    resultSpan.innerHTML = result;
                }
            }

            function searchFlightsButton() {
                var from = document.getElementById('fromAirport').value.trim();
                var to = document.getElementById('toAirport').value.trim();
                var date = document.getElementById('flightDate').value.trim();
                var priceInputs = document.querySelectorAll('.priceRangeClass .rangeAmount');
                var minPrice = priceInputs[0].value.trim();
                var maxPrice = priceInputs[1].value.trim();

                // Build query string
                var params = [];
                if (from) params.push('origin=' + encodeURIComponent(from));
                if (to) params.push('destination=' + encodeURIComponent(to));
                if (date) params.push('date=' + encodeURIComponent(date));
                if (minPrice) params.push('minPrice=' + encodeURIComponent(minPrice));
                if (maxPrice) params.push('maxPrice=' + encodeURIComponent(maxPrice));
                var queryString = params.length ? '?' + params.join('&') : '';

                // Call backend API
                fetch('http://localhost:3000/api/flights/search' + queryString)
                    .then(response => response.json())
                    .then(data => {
                        renderFlightResults(data);
                    })
                    .catch(error => {
                        console.error('Error searching flights:', error);
                        renderFlightResults([]);
                    });
            }

            function renderFlightResults(flights) {
                var container = document.getElementById('flightResults');
                container.innerHTML = '';
                if (!flights.length) {
                    container.innerHTML = '<div style="padding:20px;">No flights found.</div>';
                    return;
                }
                flights.forEach(function(flight) {
                    var card = document.createElement('div');
                    card.className = 'flightResultCard';
                    card.innerHTML = `
                        <div class="flightResultCardTop">
                            <div class="flightResultMain">
                                <div class="flightResultHeader"><span class="flightAirline">${flight.airline}</span> <span class="flightNumber">${flight.flightNumber}</span></div>
                                <div class="flightResultRoute">${flight.origin} &rarr; ${flight.destination}</div>
                                <div class="flightResultDetails">
                                    <b>Departure:</b> ${new Date(flight.departureDateTime).toLocaleString()}<br>
                                    <b>Arrival:</b> ${new Date(flight.arrivalDateTime).toLocaleString()}<br>
                                    <b>Class:</b> ${flight.class} &nbsp; <b>Stops:</b> ${flight.stops} &nbsp; <b>Duration:</b> ${flight.duration}
                                </div>
                            </div>
                        </div>
                        <div class="flightResultBottom">
                            <div class="flightResultPrice">$${flight.price}</div>
                            <button class="bookNowButton" onclick="bookNow(${flight.id})">Book Now</button>
                        </div>
                    `;
                    container.appendChild(card);
                });
            }

            function bookNow(flightId) {
                window.location.href = `/frontend/pages/booking_seat/index.html?id=${flightId}`;
            }

            function joinTodayButton() {}

            document.addEventListener('DOMContentLoaded', function() {
                fetch('../../data/flights.json')
                    .then(response => response.json())
                    .then(flights => {
                        if (flights.flights) flights = flights.flights;
                        const origins = new Set();
                        const destinations = new Set();
                        flights.forEach(f => {
                            origins.add(f.origin);
                            destinations.add(f.destination);
                        });
                        const fromSelect = document.getElementById('fromAirport');
                        const toSelect = document.getElementById('toAirport');
                        fromSelect.innerHTML = '<option value="">Select Origin</option>' +
                            Array.from(origins).map(o => `<option value="${o}">${o}</option>`).join('');
                        toSelect.innerHTML = '<option value="">Select Destination</option>' +
                            Array.from(destinations).map(d => `<option value="${d}">${d}</option>`).join('');
                    });
            });

         </script>
        <script>
        function loadHTML(url, elementId, callback) {
            fetch(url)
                .then(response => response.text())
                .then(data => {
                    document.getElementById(elementId).innerHTML = data;
                    if (callback) callback();
                })
                .catch(error => console.error('Error loading HTML:', error));
        }

        document.addEventListener('DOMContentLoaded', function() {
            loadHTML('../../components/header.html', 'header-placeholder');
        });
        </script>
        <script src="../../js/api_client.js"></script>

    </body>
</html>
